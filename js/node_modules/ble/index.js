import Promise from 'bluebird';
import BleManager from 'react-native-ble-manager';
import './bleStatusManager';
import v2 from './v2/PeskController';

const peskController = new v2();

BleManager.start({ showAlert: false });
BleManager.checkState();

function connect(deviceData) {
  return peskController.connect({
    connId: deviceData.ssid, // connId would be device SSID
    serviceId: deviceData.connId, // device.connId = serviceId
  });
}

function reset() {
  console.log('[ble] reset');
  return Promise.attempt(() => peskController.reset()).delay(1000);
}

export default {
  connect,
  reset,
  peskController,
};
