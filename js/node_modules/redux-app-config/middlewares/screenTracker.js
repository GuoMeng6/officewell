/* eslint-disable */
// gets the current screen from navigation state
function getRouteName(state) {
  if (!state.navigation) return null;

  const { currentNavigatorUID, navigators } = state.navigation;
  if (!currentNavigatorUID) return null;

  const { index, routes } = navigators[currentNavigatorUID];
  return `[${currentNavigatorUID}] ${routes[index].routeName || routes[index].key}`;
}

export default store => next => action => {
  if (!action.type.startsWith('EX_NAVIGATION')) return next(action);
  const currentScreen = getRouteName(store.getState());
  const result = next(action);
  const nextScreen = getRouteName(store.getState());
  if (nextScreen !== currentScreen) {
    console.debug('[tracker]', nextScreen);
  }
  return result;
};
